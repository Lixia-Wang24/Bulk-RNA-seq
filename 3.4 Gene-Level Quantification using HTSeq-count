This script block outlines the steps for calculating raw read counts per gene using HTSeq-count on the processed BAM files, followed by cleaning and merging the count files.
# Define Genome reference and directory (currently commented out)
#Genome=GRCh38
#Genomedir=/Users/lixia/Data/database/ref_genome/GRCh38.NCBI
#mkdir -p DEseq2

# Define sample list (currently commented out)
#sample="HEK293T.Ctl.Rep1 HEK293T.Ctl.Rep2 HEK293T.NES.Rep1 HEK293T.NES.Rep2"

# Loop for HTSeq-count (currently commented out)
#for s in $sample
#do
#    # HTSeq-count command:
#    # -f bam: Input file format is BAM
#    # -r name: Sort by read name (required if not using position-sorted BAM)
#    # -m intersection-nonempty: Counting mode
#    # -s reverse: Strandedness (reverse strand)
#    # -i gene_id: Use 'gene_id' attribute in GTF for features
#    # -t exon: Only count reads aligned to features of type 'exon'
#    htseq-count -f bam -r name -m intersection-nonempty -s reverse $s.uniq.nodup.bam -i gene_id -t exon $Genomedir/$Genome.gtf 1>./DEseq2/$s.uniq.exp 2>./DEseq2/$s.uniq.err
#done

######### Remove counts assigned to ambiguous gene annotations (currently commented out) ################
#grep __ -v ./DEseq2/$s.uniq.exp > ./DEseq2/$s.uniq.clean.exp

########## Merge count files ###################
cd ./DEseq2

# Create the merged count header file (currently commented out)
#echo -en "gene\tHEK293T.NES.Rep1\tHEK293T.Ctl.Rep1\tHEK293T.NES.Rep2\tHEK293T.Ctl.Rep2\n" > test.count

# Merge the cleaned count files into a single matrix (currently commented out)
#paste HEK293T.NES.Rep1.uniq.clean.exp HEK293T.Ctl.Rep1.uniq.clean.exp HEK293T.NES.Rep2.uniq.clean.exp HEK293T.Ctl.Rep2.uniq.clean.exp | cut -f1,2,4,6,8 >> test.count
